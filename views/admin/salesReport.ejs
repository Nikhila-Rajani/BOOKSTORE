<!DOCTYPE HTML>
<html lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-transactions-2.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:33 GMT -->

<head>
    <meta charset="utf-8">
    <title>BOOKWORM ADMIN</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/admin-assets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link href="/admin-assets/css/main.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="screen-overlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
        <div class="aside-top">
            <a href="index.html" class="brand-wrap">
                <img src="/admin-assets\imgs\theme\bookWorm.png" class="logo" alt="Evara Dashboard">
            </a>
            <div>
                <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i>
                </button>
            </div>
        </div>
        <nav>
            <ul class="menu-aside">
                <li class=" ">
                    <a class="menu-link" href="adminDashboard"> <i class="icon material-icons md-home"></i>
                        <span class="text">Dashboard</span>
                    </a>
                </li>
                <li class="">
                    <a class="menu-link" href="adminproduct"> <i class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Products</span>
                    </a>

                </li>
                <li class="">
                    <a class="menu-link" href="adminCategory"><i class="icon material-icons md-solid md-list"></i>
                        <span class="text">Catagory</span>
                    </a>

                </li>
                <li class="menu-item ">
                    <a class="menu-link" href="orderList"> <i class="icon material-icons md-shopping_cart"></i>
                        <span class="text">Orders</span>
                    </a>
                </li>

                <li class="">
                    <a class="menu-link" href="adminUser"> <i class="icon material-icons md-person"></i>
                        <span class="text">Users</span>
                    </a>
                </li>
                <li class="">
                    <a class="menu-link" href="allCoupon"> <i class="icon material-icons md-local_offer"></i>
                        <span class="text">Coupon</span>
                    </a>
                </li>
                <li class="">
                    <a class="menu-link" href="salesReport"> <i class="icon material-icons md-monetization_on"></i>
                        <span class="text">Sales</span>
                    </a>
                </li>
                <li class="">
                    <a class="menu-link" href="addOffer"> <i class="icon material-icons md-shopping_cart"></i>
                        <span class="text">Offers</span>
                    </a>
                </li>
            </ul>
            <hr>
            <br>
            <br>
        </nav>
    </aside>
    <main class="main-wrap">
        <header class="main-header navbar">
            <div class="col-search">
                <form class="searchform">
                    <div class="input-group">
                        <input list="search_terms" type="text" class="form-control" placeholder="Search term">
                        <button class="btn btn-light bg" type="button"> <i
                                class="material-icons md-search"></i></button>
                    </div>
                    <datalist id="search_terms">
                        <option value="Products">
                        <option value="New orders">
                        <option value="Apple iphone">
                        <option value="Ahmed Hassan">
                    </datalist>
                </form>
            </div>
            <div class="col-nav">
                <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"> <i
                        class="material-icons md-apps"></i> </button>
                <ul class="nav">
                    <li class="nav-item">
                        <a class="nav-link btn-icon" href="#">
                            <i class="material-icons md-notifications animation-shake"></i>
                            <span class="badge rounded-pill">3</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn-icon darkmode" href="#"> <i class="material-icons md-nights_stay"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="requestfullscreen nav-link btn-icon"><i
                                class="material-icons md-cast"></i></a>
                    </li>
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownLanguage"
                            aria-expanded="false"><i class="material-icons md-public"></i></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownLanguage">
                            <a class="dropdown-item text-brand" href="#"><img src="/admin-assets/imgs/theme/flag-us.png"
                                    alt="English">English</a>
                            <a class="dropdown-item" href="#"><img src="/admin-assets/imgs/theme/flag-fr.png"
                                    alt="Français">Français</a>
                            <a class="dropdown-item" href="#"><img src="/admin-assets/imgs/theme/flag-jp.png"
                                    alt="Français">日本語</a>
                            <a class="dropdown-item" href="#"><img src="/admin-assets/imgs/theme/flag-cn.png"
                                    alt="Français">中国人</a>
                        </div>
                    </li>
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownAccount"
                            aria-expanded="false"> <img class="img-xs rounded-circle"
                                src="/admin-assets/imgs/people/avatar2.jpg" alt="User"></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownAccount">
                            <a class="dropdown-item" href="#"><i class="material-icons md-perm_identity"></i>Edit
                                Profile</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-settings"></i>Account
                                Settings</a>
                            <a class="dropdown-item" href="#"><i
                                    class="material-icons md-account_balance_wallet"></i>Wallet</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-receipt"></i>Billing</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-help_outline"></i>Help
                                center</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="#"><i
                                    class="material-icons md-exit_to_app"></i>Logout</a>
                        </div>
                    </li>
                </ul>
            </div>
        </header>
        <!-- <section class="content-main">
            <div class="content-header">
                <h2 class="content-title">Transactions </h2>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-9">
                            <header class="border-bottom mb-4 pb-4">
                                <div class="row">
                                    <div class="col-lg-5 col-6 me-auto">
                                        <input type="text" placeholder="Search..." class="form-control">
                                    </div>
                                    <div class="col-lg-2 col-6">
                                        <select class="form-select">
                                            <option>Method</option>
                                            <option>Master card</option>
                                            <option>Visa card</option>
                                            <option>Paypal</option>
                                        </select>
                                    </div>
                                </div>
                            </header> card-header end//
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Transaction ID</th>
                                            <th>Paid</th>
                                            <th>Method</th>
                                            <th>Date</th>
                                            <th class="text-end"> Action </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><b>#456667</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="/admin-assets/imgs/card-brands/1.png" alt="Payment">
                                                    <span class="text text-muted">Amex</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#134768</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="admin-assets/imgs/card-brands/2.png" alt="Payment">
                                                    <span class="text text-muted">Master card</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#134768</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="/admin-assets/imgs/card-brands/3.png" alt="Payment">
                                                    <span class="text text-muted">Paypal</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#134768</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="/admin-assets/imgs/card-brands/4.png" alt="Payment">
                                                    <span class="text text-muted">Visa</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#887780</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="admin-assets/imgs/card-brands/4.png" alt="Payment">
                                                    <span class="text text-muted">Visa</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#344556</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="/admin-assets/imgs/card-brands/4.png" alt="Payment">
                                                    <span class="text text-muted">Visa</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#134768</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="/admin-assets/imgs/card-brands/2.png" alt="Payment">
                                                    <span class="text text-muted">Master card</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#134768</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="admin-assets/imgs/card-brands/2.png" alt="Payment">
                                                    <span class="text text-muted">Master card</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#998784</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="/admin-assets/imgs/card-brands/3.png" alt="Payment">
                                                    <span class="text text-muted">Paypal</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#556667</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="/admin-assets/imgs/card-brands/3.png" alt="Payment">
                                                    <span class="text text-muted">Paypal</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#098989</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="/admin-assets/imgs/card-brands/3.png" alt="Payment">
                                                    <span class="text text-muted">Paypal</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><b>#134768</b></td>
                                            <td>$294.00</td>
                                            <td>
                                                <div class="icontext">
                                                    <img class="icon border" src="/admin-assets/imgs/card-brands/4.png" alt="Payment">
                                                    <span class="text text-muted">Visa</span>
                                                </div>
                                            </td>
                                            <td>16.12.2020, 14:21</td>
                                            <td class="text-end">
                                                <a href="#" class="btn btn-sm btn-light font-sm rounded">Details</a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div> 
                        <aside class="col-lg-3">
                            <div class="box bg-light" style="min-height:80%">
                                <h6 class="mt-15">Transaction Details</h6>
                                <hr>
                                <h6 class="mb-0">Suplier:</h6>
                                <p>TemplateMount</p><br>
                                <h6 class="mb-0">Date:</h6>
                                <p>December 19th, 2020</p><br>
                                <h6 class="mb-0">Billing address</h6>
                                <p>1901 Thornridge Cir. Shiloh, Hawaii 81063</p><br>
                                <h6 class="mb-0">VAT ID:</h6>
                                <p>54741654160</p><br>
                                <h6 class="mb-0">Email:</h6>
                                <p><template class="__cf_email__" data-cfemail="9cefe9ececf3eee8dcf9e4fdf1ecf0f9b2fff3f1">[email&#160;protected]</template></p><br>
                                <h6 class="mb-0">Item purchased:</h6><br>
                                <p>
                                    <a href="#"> Adidas Air Jordan <i class="icons material-icons md-launch"></i> </a>
                                    <br>
                                    <a href="#"> Great product <i class="icons material-icons md-launch"></i> </a>
                                </p>
                                <br>
                                <p>Payment: PayPal</p>
                                <p class="h4">$457.14</p>
                                <hr>
                                <a class="btn btn-light" href="#"> Download receipe </a>
                            </div>
                        </aside> col end//
                    </div> row end//
                </div> card-body //
            </div> card end//
            <div class="pagination-area mt-30 mb-50">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-start">
                        <li class="page-item active"><a class="page-link" href="#">01</a></li>
                        <li class="page-item"><a class="page-link" href="#">02</a></li>
                        <li class="page-item"><a class="page-link" href="#">03</a></li>
                        <li class="page-item"><a class="page-link dot" href="#">...</a></li>
                        <li class="page-item"><a class="page-link" href="#">16</a></li>
                        <li class="page-item"><a class="page-link" href="#"><i class="material-icons md-chevron_right"></i></a></li>
                    </ul>
                </nav>
            </div> -->
        <!-- </section> -->
        <section class="content-main">
            <div class="content-header">
                <h2 class="content-title" style="color: black;">Sales Reports</h2>
                <div>

                    <a class="btn btn-sm rounded mx-2" style="background-color: #151413; color: aliceblue;"
                        id="getPdfButton" onclick="pdf()">Get Pdf</a>

                    <a class="btn btn-sm rounded" style="background-color: rgb(255, 236, 178);color: black;"
                        onclick="excel()">Get Excel</a>
                </div>
            </div>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-12">
                            <header class="border-bottom mb-4 pb-4">
                                <div class="row d-flex justify-content-between">
                                    <p id="err" class="text-danger"></p>
                                    <p id="err1" class="text-danger"></p>
                                    <div class="col-lg-4 col-6 d-flex" style="display:none !important" id="costumdate">
                                        <input type="date" id="startdate" class="form-control w-50 mx-2">
                                        <input type="date" id="enddate" class="form-control w-50 mx-2">
                                        <a onclick="filterDate()" class="btn mx-2 text-center"
                                            style="background-color: rgb(243, 240, 231);color: black;">Take</a>
                                    </div>
                                    <div class="col-lg-2 col-6">
                                        <select class="form-select" onchange="dateChange()">
                                            <option>Daily</option>
                                            <option>Weekly</option>
                                            <option>Monthly</option>
                                            <option>Yearly</option>
                                            <option value="custom">Custom</option>
                                        </select>
                                    </div>
                                </div>
                            </header>
                            <div class="table-responsive">
                                <table class="table table-hover" id="table">
                                    <thead style="background-color: #0b0a09;  ">
                                        <tr style="color: aliceblue;">
                                            <th>OrderID</th>
                                            <th>Email</th>
                                            <th>Date</th>
                                            <th>Coupen</th>
                                            <th>Discount</th>
                                            <th>Total</th>
                                            <th class="text-end">Payment Method</th>
                                        </tr>
                                    </thead>
                                    <tbody style="color: black;">
                                        <% orderData.forEach(element=> { %>
                                            <tr>
                                                <td><b>
                                                        <%= element._id %>
                                                    </b></td>
                                                <td>
                                                    <%= element.user %>
                                                </td>
                                                <td>
                                                    <%= element.date %>
                                                </td>
                                                <td>No Coupen</td>
                                                <td>No discount</td>
                                                <td>
                                                    <%= element.totalamount %>
                                                </td>
                                                <td class="text-end">
                                                    <%= element.paymentMethod %>
                                                </td>
                                            </tr>
                                            <% }) %>
                                    </tbody>
                                </table>
                            </div>

                            <div class="table-responsive col-lg-6 offset-lg-6">
                                <table class="table table-hover" id="table1">
                                    <thead style="background-color: #0e0c0c;">
                                        <tr style="color: aliceblue;">
                                            <th>Total Orders</th>
                                            <th>Total Order Amounts</th>
                                            <th>Total Discounts</th>
                                        </tr>
                                    </thead>
                                    <tbody style="color: black;">
                                        <tr>
                                            <td><b>
                                                    <%= orderCount %>
                                                </b></td>
                                            <td>
                                                <%= totalAmount %>
                                            </td>
                                            <td>total</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="pagination-area mt-30 mb-50">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-start">

                        <% for( let i=1; i <=numofPage; i++ ) { %>
                            <li class="page-item "><a class="page-link" href="/admin/salesReport?page=<%= i %>">
                                    <%= i %>
                                </a></li>


                            <% } %>

                    </ul>
                </nav>
            </div>


        </section>
        <!-- <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
                    document.write(new Date().getFullYear())
                    </script> ©, Evara - HTML Ecommerce Template .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer> -->
    </main>
    <script src="/admin-assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="/admin-assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="/admin-assets/js/vendors/select2.min.js"></script>
    <script src="/admin-assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="/admin-assets/js/vendors/jquery.fullscreen.min.js"></script>
    <!-- Main Script -->
    <script src="/admin-assets/js/main.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</body>
<script>

    function pdf() {
        const table = document.getElementById("table");

        console.log(table)
        html2pdf().from(table).save();
    }
    function excel() {
        /* Retrieve table data */

        var table = document.getElementById('table');
        var tableData = [];
        var rows = table.rows;
        for (var i = 0; i < rows.length; i++) {
            var rowData = [];
            var cells = rows[i].cells;
            for (var j = 0; j < cells.length; j++) {
                rowData.push(cells[j].innerText);
            }
            tableData.push(rowData);
        }

        /* Convert table data to Excel file */
        var worksheet = XLSX.utils.aoa_to_sheet(tableData);
        var workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');
        var excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });

        /* Save the Excel file */
        saveAsExcelFile(excelBuffer, 'table_data.xlsx');
    }

    function saveAsExcelFile(buffer, fileName) {
        var data = new Blob([buffer], { type: 'application/octet-stream' });
        var url = window.URL.createObjectURL(data);
        var link = document.createElement('a');
        link.href = url;
        link.download = fileName;
        link.click();
        setTimeout(function () {
            window.URL.revokeObjectURL(url);
        }, 100);
    }

    function filterDate() {
        const startDate = document.getElementById('startdate').value
        const endDate = document.getElementById('enddate').value

        const dateError = document.getElementById('err')
        const dateError1 = document.getElementById('err1')

        dateError.textContent = ""
        dateError1.textContent = ""


        if (startDate > endDate) {
            dateError.textContent = "This date should not be future date"
        } else if (endDate < startDate) {
            dateError1.textContent = "This date should not be previous date "
        } else {
            $.ajax({
                url: '/admin/salesReport',
                method: 'post',
                data: {
                    startDate,
                    endDate
                },
                success: (response) => {
                    if (response.orders) {
                        displayOrders(response.orders)
                    }
                }
            })
        }
    }

    function displayOrders(orders) {
        const tbody = document.querySelector('table tbody')
        tbody.innerHTML = ""

        orders.forEach(order => {
            const row = document.createElement('tr')
            row.innerHTML = `
                          <td><b>${order._id}</b></td>
                          <td>${order.user}</td>
                          <td>${(order.date)}</td>
                          <td>No Coupon</td>
                          <td>No Discount</td>
                          <td>${order.totalamount}</td>
                          <td class="text-end">${order.paymentMethod}</td>
                      `;
            tbody.appendChild(row)
        })
    }

    function dateChange() {

        const selectOption = document.querySelector('.form-select').value
        if (selectOption === 'custom') {
            document.getElementById('costumdate').style.display = 'block'
        }

        $.ajax({
            url: '/admin/daterangesales',
            method: 'post',
            data: {
                selectOption
            },
            success: (response) => {
                if (response.orders) {
                    displayOrders(response.orders)
                }
            }

        })

    }
</script>

<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-transactions-2.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:33 GMT -->

</html>